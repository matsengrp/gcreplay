{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Analysis Results","text":"<p>Welcome to the analysis results site. This site contains:</p> <ul> <li>Jupyter notebooks with different analysis variations</li> <li>Interactive figures generated from the analysis</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Use the navigation tabs above to explore the analysis notebooks and interactive figures.</p>"},{"location":"analysis/cell-summaries/default/","title":"Default","text":"In\u00a0[1]: Copied! <pre>import os\nimport pandas as pd\nimport seaborn as sns\n# import matplotlib\n# matplotlib.use('Agg')\nimport matplotlib.pyplot as plt\n# %matplotlib inline\n</pre> import os import pandas as pd import seaborn as sns # import matplotlib # matplotlib.use('Agg') import matplotlib.pyplot as plt # %matplotlib inline In\u00a0[2]: parameters Copied! <pre>metadata_csv = \"../../gc_metadata.csv\"\ncell_table_csv = \"../results/observed-seqs.csv\"\nranking_subdir = \"default\"\nnds_lb_summary_csv = \"../results/notebooks/NDS_LB/default/data.csv\"\noutbase = \"_ignore/cell-summaries\"\nworkflow_env_exec = False\n</pre> metadata_csv = \"../../gc_metadata.csv\" cell_table_csv = \"../results/observed-seqs.csv\" ranking_subdir = \"default\" nds_lb_summary_csv = \"../results/notebooks/NDS_LB/default/data.csv\" outbase = \"_ignore/cell-summaries\" workflow_env_exec = False In\u00a0[3]: injected-parameters Copied! <pre># Parameters\nmetadata_csv = \"gc_metadata.csv\"\ncell_table_csv = \"observed-seqs.csv\"\nranking_subdir = \"default\"\nnds_lb_summary_csv = \"data.csv\"\noutbase = \".\"\nworkflow_env_exec = True\n</pre> # Parameters metadata_csv = \"gc_metadata.csv\" cell_table_csv = \"observed-seqs.csv\" ranking_subdir = \"default\" nds_lb_summary_csv = \"data.csv\" outbase = \".\" workflow_env_exec = True  In\u00a0[4]: Copied! <pre>output_dir = f\"{outbase}/{ranking_subdir}\"\nif not os.path.exists(output_dir):\n    os.makedirs(output_dir)\n</pre> output_dir = f\"{outbase}/{ranking_subdir}\" if not os.path.exists(output_dir):     os.makedirs(output_dir) In\u00a0[5]: Copied! <pre>metadata = pd.read_csv(metadata_csv, index_col=0).query(\"cell_type == 'GC' and strain == 'wt'\")\nmetadata\n</pre> metadata = pd.read_csv(metadata_csv, index_col=0).query(\"cell_type == 'GC' and strain == 'wt'\") metadata Out[5]: ngs_id imm_duration mouse gc strain node cell_type plate hc_barcode lc_barcode row col uid D15_M1_GC1 PR-2-01 d15 1 1 wt RP GC 2 9 9 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M1_GC2 PR-2-01 d15 1 2 wt RI GC 3 2 1 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M1_GC3 PR-2-01 d15 1 3 wt LI GC 4 14 2 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M2_GC4 PR-2-01 d15 2 4 wt RP GC 5 10 11 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M3_GC5 PR-2-01 d15 3 5 wt RP GC 6 7 4 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 ... ... ... ... ... ... ... ... ... ... ... ... ... D20_M24_GC115 PR-1-04 d20 24 115 wt RP GC 72 16 16 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC116 PR-1-02 d20 25 116 wt RP GC 65 8 8 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC117 PR-1-03 d20 25 117 wt RP GC 68 9 9 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC118 PR-1-08 d20 25 118 wt RP GC 66 15 15 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC119 PR-1-08 d20 25 119 wt RP GC 67 16 16 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 <p>119 rows \u00d7 12 columns</p> In\u00a0[6]: Copied! <pre>cell_table = pd.read_csv(cell_table_csv).query(\"uid in @metadata.index\")\ncell_table.to_csv(f\"{output_dir}/cell_table.csv\", index=False)\ncell_table\n</pre> cell_table = pd.read_csv(cell_table_csv).query(\"uid in @metadata.index\") cell_table.to_csv(f\"{output_dir}/cell_table.csv\", index=False) cell_table Out[6]: ID_HK well uid ngs_id mouse gc node cell_type imm_duration aa_substitutions_IMGT ... fasta_header_HC fasta_header_LC fasta_seq_HC fasta_seq_LC partis_sequence_HC partis_sequence_LC seq_aa_HC seq_aa_LC seq_nt_HC seq_nt_LC 0 230512P15A02HK A02 D15_M6_GC11 PR-2-01 6 11 RP GC d15 P9(H)L S11(H)G I42(H)L S64(H)C R106(H)W R67(L)... ... PR-2-01.230512.P15.A02.H.R.1-51 PR-2-01.230512.P14.A02.K.R.1-442 GAGGTGCAGCTTCAGGAGTCAGGACTTGGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACTTGGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGLGLVKPSQTLSLTCSVTGDSITSGYWNWLRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacttggcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 1 230512P15A03HK A03 D15_M6_GC11 PR-2-01 6 11 RP GC d15 M53(H)V S57(H)N Y67(H)S K51(L)R A52(L)S N93(L)... ... PR-2-01.230512.P15.A03.H.R.1-211 PR-2-01.230512.P14.A03.K.R.1-332 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPRS... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 2 230512P15A04HK A04 D15_M6_GC11 PR-2-01 6 11 RP GC d15 T96(H)N Y103(H)* A105(H)G ... PR-2-01.230512.P15.A04.H.R.1-67 PR-2-01.230512.P14.A04.K.R.1-364 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 3 230512P15A05HK A05 D15_M6_GC11 PR-2-01 6 11 RP GC d15 S64(H)G K84(H)Q N92(H)K A105(H)G N108(L)K T117... ... PR-2-01.230512.P15.A05.H.R.1-54 PR-2-01.230512.P14.A05.K.R.1-453 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 4 230512P15A06HK A06 D15_M6_GC11 PR-2-01 6 11 RP GC d15 T18(H)P N40(H)S T65(H)N A100(H)V T122(H)M K51(... ... PR-2-01.230512.P15.A06.H.R.1-46 PR-2-01.230512.P14.A06.K.R.1-194 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQPLSLTCSVTGDSITSGYWSWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPRS... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 10424 211014P07H08HK H08 D20_M22_GC88 PR-1-03 22 88 LP GC d20 T26(H)S Y55(H)F L116(L)P ... PR-1-03.211014.P07.H08.H.R.1-72 PR-1-03.211014.P07.H08.K.R.1-22 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVSGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10425 211014P07H09HK H09 D20_M22_GC88 PR-1-03 22 88 LP GC d20 S64(H)N A105(H)G T37(L)A Y68(L)F Q105(L)H ... PR-1-03.211014.P07.H09.H.R.1-13 PR-1-03.211014.P07.H09.K.R.1-164 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTGGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10426 211014P07H10HK H10 D20_M22_GC88 PR-1-03 22 88 LP GC d20 S64(H)G T79(H)A N92(H)I A105(H)G T37(L)A N108(... ... PR-1-03.211014.P07.H10.H.R.1-11 PR-1-03.211014.P07.H10.K.R.1-175 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10427 211014P07H11HK H11 D20_M22_GC88 PR-1-03 22 88 LP GC d20 D28(H)A S57(H)N N92(H)I A105(H)G T37(L)A A57(L... ... PR-1-03.211014.P07.H11.H.R.1-14 PR-1-03.211014.P07.H11.K.R.1-188 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTTG... EVQLQESGPSLVKPSQTLSLTCSVTGASITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagttg... 10428 211014P07H12HK H12 D20_M22_GC88 PR-1-03 22 88 LP GC d20 D81(H)H N92(H)I A105(H)G T37(L)A S92(L)N Q105(L)H ... PR-1-03.211014.P07.H12.H.R.1-9 PR-1-03.211014.P07.H12.K.R.1-235 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... <p>8744 rows \u00d7 64 columns</p> In\u00a0[7]: Copied! <pre>plt.figure(figsize=(13, 5))\nsns.pointplot(\n    data=cell_table,\n    hue=\"imm_duration\",\n    x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_bind=\"median\")).sort_values([\"imm_duration\", \"delta_bind\"]).index,\n    y=\"delta_bind\",\n    estimator=\"median\",\n    errorbar=(\"pi\", 50),\n    )\nplt.axhline(0, color=\"black\", linestyle=\"--\")\nplt.xticks(rotation=90)\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/delta_bind.pdf\")\nplt.show()\n</pre> plt.figure(figsize=(13, 5)) sns.pointplot(     data=cell_table,     hue=\"imm_duration\",     x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_bind=\"median\")).sort_values([\"imm_duration\", \"delta_bind\"]).index,     y=\"delta_bind\",     estimator=\"median\",     errorbar=(\"pi\", 50),     ) plt.axhline(0, color=\"black\", linestyle=\"--\") plt.xticks(rotation=90) plt.tight_layout() plt.savefig(f\"{output_dir}/delta_bind.pdf\") plt.show() In\u00a0[8]: Copied! <pre>plt.figure(figsize=(13, 5))\nsns.pointplot(\n    data=cell_table,\n    hue=\"imm_duration\",\n    x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_expr=\"median\")).sort_values([\"imm_duration\", \"delta_expr\"]).index,\n    y=\"delta_expr\",\n    estimator=\"median\",\n    errorbar=(\"pi\", 50),\n    )\nplt.axhline(0, color=\"black\", linestyle=\"--\")\nplt.xticks(rotation=90)\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/delta_expr.pdf\")\nplt.show()\n</pre> plt.figure(figsize=(13, 5)) sns.pointplot(     data=cell_table,     hue=\"imm_duration\",     x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_expr=\"median\")).sort_values([\"imm_duration\", \"delta_expr\"]).index,     y=\"delta_expr\",     estimator=\"median\",     errorbar=(\"pi\", 50),     ) plt.axhline(0, color=\"black\", linestyle=\"--\") plt.xticks(rotation=90) plt.tight_layout() plt.savefig(f\"{output_dir}/delta_expr.pdf\") plt.show() In\u00a0[9]: Copied! <pre>g = sns.JointGrid(data=cell_table, x=\"delta_bind\", y=\"delta_expr\", hue=\"imm_duration\")\ng.plot_joint(sns.scatterplot)\ng.plot_marginals(sns.kdeplot, common_norm=False, fill=True, alpha=0.1)\ng.ax_joint.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_joint.axhline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\")\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/joint_cells.pdf\")\nplt.show()\n</pre>  g = sns.JointGrid(data=cell_table, x=\"delta_bind\", y=\"delta_expr\", hue=\"imm_duration\") g.plot_joint(sns.scatterplot) g.plot_marginals(sns.kdeplot, common_norm=False, fill=True, alpha=0.1) g.ax_joint.axvline(0, color=\"black\", linestyle=\"--\") g.ax_joint.axhline(0, color=\"black\", linestyle=\"--\") g.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\") g.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\") plt.tight_layout() plt.savefig(f\"{output_dir}/joint_cells.pdf\") plt.show() In\u00a0[10]: Copied! <pre>gc_summary = (\n    (\n        cell_table.groupby(\"gc\").agg(\n            uid = pd.NamedAgg(column=\"uid\", aggfunc=\"first\"),\n            mouse = pd.NamedAgg(column=\"mouse\", aggfunc=\"first\"),\n            ngs_id = pd.NamedAgg(column=\"ngs_id\", aggfunc=\"first\"),\n            sampling_time=pd.NamedAgg(column=\"imm_duration\", aggfunc=\"first\"),\n            cells_sampled=pd.NamedAgg(column=\"uid\", aggfunc=\"count\"),\n            median_delta_bind=pd.NamedAgg(column=\"delta_bind\", aggfunc=\"median\"),\n            median_delta_expr=pd.NamedAgg(column=\"delta_expr\", aggfunc=\"median\")\n        )\n    )\n    .reset_index()\n    .set_index(\"uid\")\n    .rename(\n        columns={\n            'median_delta_bind': 'median \u0394affinity',\n            'median_delta_expr': 'median \u0394expression'\n        }\n    )\n)\n\ngc_summary\n</pre> gc_summary = (     (         cell_table.groupby(\"gc\").agg(             uid = pd.NamedAgg(column=\"uid\", aggfunc=\"first\"),             mouse = pd.NamedAgg(column=\"mouse\", aggfunc=\"first\"),             ngs_id = pd.NamedAgg(column=\"ngs_id\", aggfunc=\"first\"),             sampling_time=pd.NamedAgg(column=\"imm_duration\", aggfunc=\"first\"),             cells_sampled=pd.NamedAgg(column=\"uid\", aggfunc=\"count\"),             median_delta_bind=pd.NamedAgg(column=\"delta_bind\", aggfunc=\"median\"),             median_delta_expr=pd.NamedAgg(column=\"delta_expr\", aggfunc=\"median\")         )     )     .reset_index()     .set_index(\"uid\")     .rename(         columns={             'median_delta_bind': 'median \u0394affinity',             'median_delta_expr': 'median \u0394expression'         }     ) )  gc_summary Out[10]: gc mouse ngs_id sampling_time cells_sampled median \u0394affinity median \u0394expression uid D15_M1_GC1 1 1 PR-2-01 d15 67 0.773400 -0.05788 D15_M1_GC2 2 1 PR-2-01 d15 79 0.397360 -0.03688 D15_M1_GC3 3 1 PR-2-01 d15 73 0.535100 -0.06153 D15_M2_GC4 4 2 PR-2-01 d15 44 0.287630 -0.08646 D15_M3_GC5 5 3 PR-2-01 d15 78 0.000000 -0.08452 ... ... ... ... ... ... ... ... D20_M24_GC115 115 24 PR-1-04 d20 85 1.046480 -0.17240 D20_M25_GC116 116 25 PR-1-02 d20 78 1.105020 -0.03121 D20_M25_GC117 117 25 PR-1-03 d20 76 0.608315 -0.51338 D20_M25_GC118 118 25 PR-1-08 d20 70 0.491020 -0.02191 D20_M25_GC119 119 25 PR-1-08 d20 81 0.698655 -0.26017 <p>119 rows \u00d7 7 columns</p> In\u00a0[11]: Copied! <pre>cols_to_keep = [\n    # 'cells sampled',\n    'normalized dominance score',\n    'maximum REI',\n    'max \u0394affinity',\n    '95th percentile \u0394affinity',\n    # 'mean \u0394affinity',\n    # 'median \u0394affinity', \n    'id of max REI node', \n    'mutations in max REI node', \n    '\u0394affinity of max REI node',\n    '\u0394\u0394affinity of max REI node',\n    'max REI node is root'\n]\nnds_lb = pd.read_csv(nds_lb_summary_csv, index_col=\"uid\")[cols_to_keep]\nnds_lb.info()\n</pre> cols_to_keep = [     # 'cells sampled',     'normalized dominance score',     'maximum REI',     'max \u0394affinity',     '95th percentile \u0394affinity',     # 'mean \u0394affinity',     # 'median \u0394affinity',      'id of max REI node',      'mutations in max REI node',      '\u0394affinity of max REI node',     '\u0394\u0394affinity of max REI node',     'max REI node is root' ] nds_lb = pd.read_csv(nds_lb_summary_csv, index_col=\"uid\")[cols_to_keep] nds_lb.info() <pre>&lt;class 'pandas.core.frame.DataFrame'&gt;\nIndex: 119 entries, D20_M22_GC96 to D15_M13_GC31\nData columns (total 9 columns):\n #   Column                      Non-Null Count  Dtype  \n---  ------                      --------------  -----  \n 0   normalized dominance score  119 non-null    float64\n 1   maximum REI                 119 non-null    float64\n 2   max \u0394affinity               119 non-null    float64\n 3   95th percentile \u0394affinity   119 non-null    float64\n 4   id of max REI node          119 non-null    object \n 5   mutations in max REI node   113 non-null    object \n 6   \u0394affinity of max REI node   119 non-null    float64\n 7   \u0394\u0394affinity of max REI node  119 non-null    float64\n 8   max REI node is root        119 non-null    bool   \ndtypes: bool(1), float64(6), object(2)\nmemory usage: 8.5+ KB\n</pre> In\u00a0[12]: Copied! <pre>gc_summary = gc_summary.join(nds_lb)\ngc_summary.to_csv(f\"{output_dir}/gc_summary.csv\")\n</pre> gc_summary = gc_summary.join(nds_lb) gc_summary.to_csv(f\"{output_dir}/gc_summary.csv\") In\u00a0[13]: Copied! <pre>gc_summary.info()\n</pre> gc_summary.info() <pre>&lt;class 'pandas.core.frame.DataFrame'&gt;\nIndex: 119 entries, D15_M1_GC1 to D20_M25_GC119\nData columns (total 16 columns):\n #   Column                      Non-Null Count  Dtype  \n---  ------                      --------------  -----  \n 0   gc                          119 non-null    int64  \n 1   mouse                       119 non-null    int64  \n 2   ngs_id                      119 non-null    object \n 3   sampling_time               119 non-null    object \n 4   cells_sampled               119 non-null    int64  \n 5   median \u0394affinity            119 non-null    float64\n 6   median \u0394expression          119 non-null    float64\n 7   normalized dominance score  119 non-null    float64\n 8   maximum REI                 119 non-null    float64\n 9   max \u0394affinity               119 non-null    float64\n 10  95th percentile \u0394affinity   119 non-null    float64\n 11  id of max REI node          119 non-null    object \n 12  mutations in max REI node   113 non-null    object \n 13  \u0394affinity of max REI node   119 non-null    float64\n 14  \u0394\u0394affinity of max REI node  119 non-null    float64\n 15  max REI node is root        119 non-null    bool   \ndtypes: bool(1), float64(8), int64(3), object(4)\nmemory usage: 19.1+ KB\n</pre> In\u00a0[14]: Copied! <pre>g = sns.JointGrid(data=gc_summary, x=\"median \u0394affinity\", y=\"median \u0394expression\", hue=\"sampling_time\")\ng.plot_joint(sns.scatterplot, size=gc_summary.cells_sampled)\ng.plot_marginals(sns.kdeplot, common_norm=False)\ng.ax_joint.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_joint.axhline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\")\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/joint_gc_medians.pdf\")\nplt.show()\n</pre> g = sns.JointGrid(data=gc_summary, x=\"median \u0394affinity\", y=\"median \u0394expression\", hue=\"sampling_time\") g.plot_joint(sns.scatterplot, size=gc_summary.cells_sampled) g.plot_marginals(sns.kdeplot, common_norm=False) g.ax_joint.axvline(0, color=\"black\", linestyle=\"--\") g.ax_joint.axhline(0, color=\"black\", linestyle=\"--\") g.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\") g.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\") plt.tight_layout() plt.savefig(f\"{output_dir}/joint_gc_medians.pdf\") plt.show() In\u00a0[15]: Copied! <pre>sns.boxenplot(data=gc_summary, y=\"median \u0394affinity\", hue=\"sampling_time\")\nplt.show()\nsns.boxenplot(data=gc_summary, y=\"median \u0394expression\", hue=\"sampling_time\")\nplt.show()\n</pre> sns.boxenplot(data=gc_summary, y=\"median \u0394affinity\", hue=\"sampling_time\") plt.show() sns.boxenplot(data=gc_summary, y=\"median \u0394expression\", hue=\"sampling_time\") plt.show()"},{"location":"analysis/cell-summaries/default/#summary-stats","title":"Summary stats\u00b6","text":""},{"location":"analysis/cell-summaries/default/#cell-wise-stats","title":"Cell-wise stats\u00b6","text":""},{"location":"analysis/cell-summaries/default/#gc-wise-stats","title":"GC-wise stats\u00b6","text":""},{"location":"analysis/cell-summaries/naive_reversions_first/","title":"Naive Reversions First","text":"In\u00a0[1]: Copied! <pre>import os\nimport pandas as pd\nimport seaborn as sns\n# import matplotlib\n# matplotlib.use('Agg')\nimport matplotlib.pyplot as plt\n# %matplotlib inline\n</pre> import os import pandas as pd import seaborn as sns # import matplotlib # matplotlib.use('Agg') import matplotlib.pyplot as plt # %matplotlib inline In\u00a0[2]: parameters Copied! <pre>metadata_csv = \"../../gc_metadata.csv\"\ncell_table_csv = \"../results/observed-seqs.csv\"\nranking_subdir = \"default\"\nnds_lb_summary_csv = \"../results/notebooks/NDS_LB/default/data.csv\"\noutbase = \"_ignore/cell-summaries\"\nworkflow_env_exec = False\n</pre> metadata_csv = \"../../gc_metadata.csv\" cell_table_csv = \"../results/observed-seqs.csv\" ranking_subdir = \"default\" nds_lb_summary_csv = \"../results/notebooks/NDS_LB/default/data.csv\" outbase = \"_ignore/cell-summaries\" workflow_env_exec = False In\u00a0[3]: injected-parameters Copied! <pre># Parameters\nmetadata_csv = \"gc_metadata.csv\"\ncell_table_csv = \"observed-seqs.csv\"\nranking_subdir = \"naive_reversions_first\"\nnds_lb_summary_csv = \"data.csv\"\noutbase = \".\"\nworkflow_env_exec = True\n</pre> # Parameters metadata_csv = \"gc_metadata.csv\" cell_table_csv = \"observed-seqs.csv\" ranking_subdir = \"naive_reversions_first\" nds_lb_summary_csv = \"data.csv\" outbase = \".\" workflow_env_exec = True  In\u00a0[4]: Copied! <pre>output_dir = f\"{outbase}/{ranking_subdir}\"\nif not os.path.exists(output_dir):\n    os.makedirs(output_dir)\n</pre> output_dir = f\"{outbase}/{ranking_subdir}\" if not os.path.exists(output_dir):     os.makedirs(output_dir) In\u00a0[5]: Copied! <pre>metadata = pd.read_csv(metadata_csv, index_col=0).query(\"cell_type == 'GC' and strain == 'wt'\")\nmetadata\n</pre> metadata = pd.read_csv(metadata_csv, index_col=0).query(\"cell_type == 'GC' and strain == 'wt'\") metadata Out[5]: ngs_id imm_duration mouse gc strain node cell_type plate hc_barcode lc_barcode row col uid D15_M1_GC1 PR-2-01 d15 1 1 wt RP GC 2 9 9 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M1_GC2 PR-2-01 d15 1 2 wt RI GC 3 2 1 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M1_GC3 PR-2-01 d15 1 3 wt LI GC 4 14 2 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M2_GC4 PR-2-01 d15 2 4 wt RP GC 5 10 11 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M3_GC5 PR-2-01 d15 3 5 wt RP GC 6 7 4 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 ... ... ... ... ... ... ... ... ... ... ... ... ... D20_M24_GC115 PR-1-04 d20 24 115 wt RP GC 72 16 16 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC116 PR-1-02 d20 25 116 wt RP GC 65 8 8 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC117 PR-1-03 d20 25 117 wt RP GC 68 9 9 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC118 PR-1-08 d20 25 118 wt RP GC 66 15 15 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC119 PR-1-08 d20 25 119 wt RP GC 67 16 16 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 <p>119 rows \u00d7 12 columns</p> In\u00a0[6]: Copied! <pre>cell_table = pd.read_csv(cell_table_csv).query(\"uid in @metadata.index\")\ncell_table.to_csv(f\"{output_dir}/cell_table.csv\", index=False)\ncell_table\n</pre> cell_table = pd.read_csv(cell_table_csv).query(\"uid in @metadata.index\") cell_table.to_csv(f\"{output_dir}/cell_table.csv\", index=False) cell_table Out[6]: ID_HK well uid ngs_id mouse gc node cell_type imm_duration aa_substitutions_IMGT ... fasta_header_HC fasta_header_LC fasta_seq_HC fasta_seq_LC partis_sequence_HC partis_sequence_LC seq_aa_HC seq_aa_LC seq_nt_HC seq_nt_LC 0 230512P15A02HK A02 D15_M6_GC11 PR-2-01 6 11 RP GC d15 P9(H)L S11(H)G I42(H)L S64(H)C R106(H)W R67(L)... ... PR-2-01.230512.P15.A02.H.R.1-51 PR-2-01.230512.P14.A02.K.R.1-442 GAGGTGCAGCTTCAGGAGTCAGGACTTGGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACTTGGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGLGLVKPSQTLSLTCSVTGDSITSGYWNWLRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacttggcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 1 230512P15A03HK A03 D15_M6_GC11 PR-2-01 6 11 RP GC d15 M53(H)V S57(H)N Y67(H)S K51(L)R A52(L)S N93(L)... ... PR-2-01.230512.P15.A03.H.R.1-211 PR-2-01.230512.P14.A03.K.R.1-332 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPRS... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 2 230512P15A04HK A04 D15_M6_GC11 PR-2-01 6 11 RP GC d15 T96(H)N Y103(H)* A105(H)G ... PR-2-01.230512.P15.A04.H.R.1-67 PR-2-01.230512.P14.A04.K.R.1-364 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 3 230512P15A05HK A05 D15_M6_GC11 PR-2-01 6 11 RP GC d15 S64(H)G K84(H)Q N92(H)K A105(H)G N108(L)K T117... ... PR-2-01.230512.P15.A05.H.R.1-54 PR-2-01.230512.P14.A05.K.R.1-453 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 4 230512P15A06HK A06 D15_M6_GC11 PR-2-01 6 11 RP GC d15 T18(H)P N40(H)S T65(H)N A100(H)V T122(H)M K51(... ... PR-2-01.230512.P15.A06.H.R.1-46 PR-2-01.230512.P14.A06.K.R.1-194 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQPLSLTCSVTGDSITSGYWSWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPRS... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 10424 211014P07H08HK H08 D20_M22_GC88 PR-1-03 22 88 LP GC d20 T26(H)S Y55(H)F L116(L)P ... PR-1-03.211014.P07.H08.H.R.1-72 PR-1-03.211014.P07.H08.K.R.1-22 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVSGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10425 211014P07H09HK H09 D20_M22_GC88 PR-1-03 22 88 LP GC d20 S64(H)N A105(H)G T37(L)A Y68(L)F Q105(L)H ... PR-1-03.211014.P07.H09.H.R.1-13 PR-1-03.211014.P07.H09.K.R.1-164 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTGGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10426 211014P07H10HK H10 D20_M22_GC88 PR-1-03 22 88 LP GC d20 S64(H)G T79(H)A N92(H)I A105(H)G T37(L)A N108(... ... PR-1-03.211014.P07.H10.H.R.1-11 PR-1-03.211014.P07.H10.K.R.1-175 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10427 211014P07H11HK H11 D20_M22_GC88 PR-1-03 22 88 LP GC d20 D28(H)A S57(H)N N92(H)I A105(H)G T37(L)A A57(L... ... PR-1-03.211014.P07.H11.H.R.1-14 PR-1-03.211014.P07.H11.K.R.1-188 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTTG... EVQLQESGPSLVKPSQTLSLTCSVTGASITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagttg... 10428 211014P07H12HK H12 D20_M22_GC88 PR-1-03 22 88 LP GC d20 D81(H)H N92(H)I A105(H)G T37(L)A S92(L)N Q105(L)H ... PR-1-03.211014.P07.H12.H.R.1-9 PR-1-03.211014.P07.H12.K.R.1-235 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... <p>8744 rows \u00d7 64 columns</p> In\u00a0[7]: Copied! <pre>plt.figure(figsize=(13, 5))\nsns.pointplot(\n    data=cell_table,\n    hue=\"imm_duration\",\n    x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_bind=\"median\")).sort_values([\"imm_duration\", \"delta_bind\"]).index,\n    y=\"delta_bind\",\n    estimator=\"median\",\n    errorbar=(\"pi\", 50),\n    )\nplt.axhline(0, color=\"black\", linestyle=\"--\")\nplt.xticks(rotation=90)\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/delta_bind.pdf\")\nplt.show()\n</pre> plt.figure(figsize=(13, 5)) sns.pointplot(     data=cell_table,     hue=\"imm_duration\",     x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_bind=\"median\")).sort_values([\"imm_duration\", \"delta_bind\"]).index,     y=\"delta_bind\",     estimator=\"median\",     errorbar=(\"pi\", 50),     ) plt.axhline(0, color=\"black\", linestyle=\"--\") plt.xticks(rotation=90) plt.tight_layout() plt.savefig(f\"{output_dir}/delta_bind.pdf\") plt.show() In\u00a0[8]: Copied! <pre>plt.figure(figsize=(13, 5))\nsns.pointplot(\n    data=cell_table,\n    hue=\"imm_duration\",\n    x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_expr=\"median\")).sort_values([\"imm_duration\", \"delta_expr\"]).index,\n    y=\"delta_expr\",\n    estimator=\"median\",\n    errorbar=(\"pi\", 50),\n    )\nplt.axhline(0, color=\"black\", linestyle=\"--\")\nplt.xticks(rotation=90)\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/delta_expr.pdf\")\nplt.show()\n</pre> plt.figure(figsize=(13, 5)) sns.pointplot(     data=cell_table,     hue=\"imm_duration\",     x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_expr=\"median\")).sort_values([\"imm_duration\", \"delta_expr\"]).index,     y=\"delta_expr\",     estimator=\"median\",     errorbar=(\"pi\", 50),     ) plt.axhline(0, color=\"black\", linestyle=\"--\") plt.xticks(rotation=90) plt.tight_layout() plt.savefig(f\"{output_dir}/delta_expr.pdf\") plt.show() In\u00a0[9]: Copied! <pre>g = sns.JointGrid(data=cell_table, x=\"delta_bind\", y=\"delta_expr\", hue=\"imm_duration\")\ng.plot_joint(sns.scatterplot)\ng.plot_marginals(sns.kdeplot, common_norm=False, fill=True, alpha=0.1)\ng.ax_joint.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_joint.axhline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\")\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/joint_cells.pdf\")\nplt.show()\n</pre>  g = sns.JointGrid(data=cell_table, x=\"delta_bind\", y=\"delta_expr\", hue=\"imm_duration\") g.plot_joint(sns.scatterplot) g.plot_marginals(sns.kdeplot, common_norm=False, fill=True, alpha=0.1) g.ax_joint.axvline(0, color=\"black\", linestyle=\"--\") g.ax_joint.axhline(0, color=\"black\", linestyle=\"--\") g.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\") g.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\") plt.tight_layout() plt.savefig(f\"{output_dir}/joint_cells.pdf\") plt.show() In\u00a0[10]: Copied! <pre>gc_summary = (\n    (\n        cell_table.groupby(\"gc\").agg(\n            uid = pd.NamedAgg(column=\"uid\", aggfunc=\"first\"),\n            mouse = pd.NamedAgg(column=\"mouse\", aggfunc=\"first\"),\n            ngs_id = pd.NamedAgg(column=\"ngs_id\", aggfunc=\"first\"),\n            sampling_time=pd.NamedAgg(column=\"imm_duration\", aggfunc=\"first\"),\n            cells_sampled=pd.NamedAgg(column=\"uid\", aggfunc=\"count\"),\n            median_delta_bind=pd.NamedAgg(column=\"delta_bind\", aggfunc=\"median\"),\n            median_delta_expr=pd.NamedAgg(column=\"delta_expr\", aggfunc=\"median\")\n        )\n    )\n    .reset_index()\n    .set_index(\"uid\")\n    .rename(\n        columns={\n            'median_delta_bind': 'median \u0394affinity',\n            'median_delta_expr': 'median \u0394expression'\n        }\n    )\n)\n\ngc_summary\n</pre> gc_summary = (     (         cell_table.groupby(\"gc\").agg(             uid = pd.NamedAgg(column=\"uid\", aggfunc=\"first\"),             mouse = pd.NamedAgg(column=\"mouse\", aggfunc=\"first\"),             ngs_id = pd.NamedAgg(column=\"ngs_id\", aggfunc=\"first\"),             sampling_time=pd.NamedAgg(column=\"imm_duration\", aggfunc=\"first\"),             cells_sampled=pd.NamedAgg(column=\"uid\", aggfunc=\"count\"),             median_delta_bind=pd.NamedAgg(column=\"delta_bind\", aggfunc=\"median\"),             median_delta_expr=pd.NamedAgg(column=\"delta_expr\", aggfunc=\"median\")         )     )     .reset_index()     .set_index(\"uid\")     .rename(         columns={             'median_delta_bind': 'median \u0394affinity',             'median_delta_expr': 'median \u0394expression'         }     ) )  gc_summary Out[10]: gc mouse ngs_id sampling_time cells_sampled median \u0394affinity median \u0394expression uid D15_M1_GC1 1 1 PR-2-01 d15 67 0.773400 -0.05788 D15_M1_GC2 2 1 PR-2-01 d15 79 0.397360 -0.03688 D15_M1_GC3 3 1 PR-2-01 d15 73 0.535100 -0.06153 D15_M2_GC4 4 2 PR-2-01 d15 44 0.287630 -0.08646 D15_M3_GC5 5 3 PR-2-01 d15 78 0.000000 -0.08452 ... ... ... ... ... ... ... ... D20_M24_GC115 115 24 PR-1-04 d20 85 1.046480 -0.17240 D20_M25_GC116 116 25 PR-1-02 d20 78 1.105020 -0.03121 D20_M25_GC117 117 25 PR-1-03 d20 76 0.608315 -0.51338 D20_M25_GC118 118 25 PR-1-08 d20 70 0.491020 -0.02191 D20_M25_GC119 119 25 PR-1-08 d20 81 0.698655 -0.26017 <p>119 rows \u00d7 7 columns</p> In\u00a0[11]: Copied! <pre>cols_to_keep = [\n    # 'cells sampled',\n    'normalized dominance score',\n    'maximum REI',\n    'max \u0394affinity',\n    '95th percentile \u0394affinity',\n    # 'mean \u0394affinity',\n    # 'median \u0394affinity', \n    'id of max REI node', \n    'mutations in max REI node', \n    '\u0394affinity of max REI node',\n    '\u0394\u0394affinity of max REI node',\n    'max REI node is root'\n]\nnds_lb = pd.read_csv(nds_lb_summary_csv, index_col=\"uid\")[cols_to_keep]\nnds_lb.info()\n</pre> cols_to_keep = [     # 'cells sampled',     'normalized dominance score',     'maximum REI',     'max \u0394affinity',     '95th percentile \u0394affinity',     # 'mean \u0394affinity',     # 'median \u0394affinity',      'id of max REI node',      'mutations in max REI node',      '\u0394affinity of max REI node',     '\u0394\u0394affinity of max REI node',     'max REI node is root' ] nds_lb = pd.read_csv(nds_lb_summary_csv, index_col=\"uid\")[cols_to_keep] nds_lb.info() <pre>&lt;class 'pandas.core.frame.DataFrame'&gt;\nIndex: 119 entries, D20_M22_GC96 to D15_M13_GC31\nData columns (total 9 columns):\n #   Column                      Non-Null Count  Dtype  \n---  ------                      --------------  -----  \n 0   normalized dominance score  119 non-null    float64\n 1   maximum REI                 119 non-null    float64\n 2   max \u0394affinity               119 non-null    float64\n 3   95th percentile \u0394affinity   119 non-null    float64\n 4   id of max REI node          119 non-null    object \n 5   mutations in max REI node   113 non-null    object \n 6   \u0394affinity of max REI node   119 non-null    float64\n 7   \u0394\u0394affinity of max REI node  119 non-null    float64\n 8   max REI node is root        119 non-null    bool   \ndtypes: bool(1), float64(6), object(2)\nmemory usage: 8.5+ KB\n</pre> In\u00a0[12]: Copied! <pre>gc_summary = gc_summary.join(nds_lb)\ngc_summary.to_csv(f\"{output_dir}/gc_summary.csv\")\n</pre> gc_summary = gc_summary.join(nds_lb) gc_summary.to_csv(f\"{output_dir}/gc_summary.csv\") In\u00a0[13]: Copied! <pre>gc_summary.info()\n</pre> gc_summary.info() <pre>&lt;class 'pandas.core.frame.DataFrame'&gt;\nIndex: 119 entries, D15_M1_GC1 to D20_M25_GC119\nData columns (total 16 columns):\n #   Column                      Non-Null Count  Dtype  \n---  ------                      --------------  -----  \n 0   gc                          119 non-null    int64  \n 1   mouse                       119 non-null    int64  \n 2   ngs_id                      119 non-null    object \n 3   sampling_time               119 non-null    object \n 4   cells_sampled               119 non-null    int64  \n 5   median \u0394affinity            119 non-null    float64\n 6   median \u0394expression          119 non-null    float64\n 7   normalized dominance score  119 non-null    float64\n 8   maximum REI                 119 non-null    float64\n 9   max \u0394affinity               119 non-null    float64\n 10  95th percentile \u0394affinity   119 non-null    float64\n 11  id of max REI node          119 non-null    object \n 12  mutations in max REI node   113 non-null    object \n 13  \u0394affinity of max REI node   119 non-null    float64\n 14  \u0394\u0394affinity of max REI node  119 non-null    float64\n 15  max REI node is root        119 non-null    bool   \ndtypes: bool(1), float64(8), int64(3), object(4)\nmemory usage: 19.1+ KB\n</pre> In\u00a0[14]: Copied! <pre>g = sns.JointGrid(data=gc_summary, x=\"median \u0394affinity\", y=\"median \u0394expression\", hue=\"sampling_time\")\ng.plot_joint(sns.scatterplot, size=gc_summary.cells_sampled)\ng.plot_marginals(sns.kdeplot, common_norm=False)\ng.ax_joint.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_joint.axhline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\")\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/joint_gc_medians.pdf\")\nplt.show()\n</pre> g = sns.JointGrid(data=gc_summary, x=\"median \u0394affinity\", y=\"median \u0394expression\", hue=\"sampling_time\") g.plot_joint(sns.scatterplot, size=gc_summary.cells_sampled) g.plot_marginals(sns.kdeplot, common_norm=False) g.ax_joint.axvline(0, color=\"black\", linestyle=\"--\") g.ax_joint.axhline(0, color=\"black\", linestyle=\"--\") g.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\") g.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\") plt.tight_layout() plt.savefig(f\"{output_dir}/joint_gc_medians.pdf\") plt.show() In\u00a0[15]: Copied! <pre>sns.boxenplot(data=gc_summary, y=\"median \u0394affinity\", hue=\"sampling_time\")\nplt.show()\nsns.boxenplot(data=gc_summary, y=\"median \u0394expression\", hue=\"sampling_time\")\nplt.show()\n</pre> sns.boxenplot(data=gc_summary, y=\"median \u0394affinity\", hue=\"sampling_time\") plt.show() sns.boxenplot(data=gc_summary, y=\"median \u0394expression\", hue=\"sampling_time\") plt.show()"},{"location":"analysis/cell-summaries/naive_reversions_first/#summary-stats","title":"Summary stats\u00b6","text":""},{"location":"analysis/cell-summaries/naive_reversions_first/#cell-wise-stats","title":"Cell-wise stats\u00b6","text":""},{"location":"analysis/cell-summaries/naive_reversions_first/#gc-wise-stats","title":"GC-wise stats\u00b6","text":""},{"location":"analysis/cell-summaries/naive_reversions_no_bp/","title":"Naive Reversions No BP","text":"In\u00a0[1]: Copied! <pre>import os\nimport pandas as pd\nimport seaborn as sns\n# import matplotlib\n# matplotlib.use('Agg')\nimport matplotlib.pyplot as plt\n# %matplotlib inline\n</pre> import os import pandas as pd import seaborn as sns # import matplotlib # matplotlib.use('Agg') import matplotlib.pyplot as plt # %matplotlib inline In\u00a0[2]: parameters Copied! <pre>metadata_csv = \"../../gc_metadata.csv\"\ncell_table_csv = \"../results/observed-seqs.csv\"\nranking_subdir = \"default\"\nnds_lb_summary_csv = \"../results/notebooks/NDS_LB/default/data.csv\"\noutbase = \"_ignore/cell-summaries\"\nworkflow_env_exec = False\n</pre> metadata_csv = \"../../gc_metadata.csv\" cell_table_csv = \"../results/observed-seqs.csv\" ranking_subdir = \"default\" nds_lb_summary_csv = \"../results/notebooks/NDS_LB/default/data.csv\" outbase = \"_ignore/cell-summaries\" workflow_env_exec = False In\u00a0[3]: injected-parameters Copied! <pre># Parameters\nmetadata_csv = \"gc_metadata.csv\"\ncell_table_csv = \"observed-seqs.csv\"\nranking_subdir = \"naive_reversions_no_bp\"\nnds_lb_summary_csv = \"data.csv\"\noutbase = \".\"\nworkflow_env_exec = True\n</pre> # Parameters metadata_csv = \"gc_metadata.csv\" cell_table_csv = \"observed-seqs.csv\" ranking_subdir = \"naive_reversions_no_bp\" nds_lb_summary_csv = \"data.csv\" outbase = \".\" workflow_env_exec = True  In\u00a0[4]: Copied! <pre>output_dir = f\"{outbase}/{ranking_subdir}\"\nif not os.path.exists(output_dir):\n    os.makedirs(output_dir)\n</pre> output_dir = f\"{outbase}/{ranking_subdir}\" if not os.path.exists(output_dir):     os.makedirs(output_dir) In\u00a0[5]: Copied! <pre>metadata = pd.read_csv(metadata_csv, index_col=0).query(\"cell_type == 'GC' and strain == 'wt'\")\nmetadata\n</pre> metadata = pd.read_csv(metadata_csv, index_col=0).query(\"cell_type == 'GC' and strain == 'wt'\") metadata Out[5]: ngs_id imm_duration mouse gc strain node cell_type plate hc_barcode lc_barcode row col uid D15_M1_GC1 PR-2-01 d15 1 1 wt RP GC 2 9 9 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M1_GC2 PR-2-01 d15 1 2 wt RI GC 3 2 1 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M1_GC3 PR-2-01 d15 1 3 wt LI GC 4 14 2 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M2_GC4 PR-2-01 d15 2 4 wt RP GC 5 10 11 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D15_M3_GC5 PR-2-01 d15 3 5 wt RP GC 6 7 4 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 ... ... ... ... ... ... ... ... ... ... ... ... ... D20_M24_GC115 PR-1-04 d20 24 115 wt RP GC 72 16 16 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC116 PR-1-02 d20 25 116 wt RP GC 65 8 8 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC117 PR-1-03 d20 25 117 wt RP GC 68 9 9 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC118 PR-1-08 d20 25 118 wt RP GC 66 15 15 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 D20_M25_GC119 PR-1-08 d20 25 119 wt RP GC 67 16 16 A.B.C.D.E.F.G.H 1.2.3.4.5.6.7.8.9.10.11.12 <p>119 rows \u00d7 12 columns</p> In\u00a0[6]: Copied! <pre>cell_table = pd.read_csv(cell_table_csv).query(\"uid in @metadata.index\")\ncell_table.to_csv(f\"{output_dir}/cell_table.csv\", index=False)\ncell_table\n</pre> cell_table = pd.read_csv(cell_table_csv).query(\"uid in @metadata.index\") cell_table.to_csv(f\"{output_dir}/cell_table.csv\", index=False) cell_table Out[6]: ID_HK well uid ngs_id mouse gc node cell_type imm_duration aa_substitutions_IMGT ... fasta_header_HC fasta_header_LC fasta_seq_HC fasta_seq_LC partis_sequence_HC partis_sequence_LC seq_aa_HC seq_aa_LC seq_nt_HC seq_nt_LC 0 230512P15A02HK A02 D15_M6_GC11 PR-2-01 6 11 RP GC d15 P9(H)L S11(H)G I42(H)L S64(H)C R106(H)W R67(L)... ... PR-2-01.230512.P15.A02.H.R.1-51 PR-2-01.230512.P14.A02.K.R.1-442 GAGGTGCAGCTTCAGGAGTCAGGACTTGGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACTTGGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGLGLVKPSQTLSLTCSVTGDSITSGYWNWLRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacttggcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 1 230512P15A03HK A03 D15_M6_GC11 PR-2-01 6 11 RP GC d15 M53(H)V S57(H)N Y67(H)S K51(L)R A52(L)S N93(L)... ... PR-2-01.230512.P15.A03.H.R.1-211 PR-2-01.230512.P14.A03.K.R.1-332 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPRS... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 2 230512P15A04HK A04 D15_M6_GC11 PR-2-01 6 11 RP GC d15 T96(H)N Y103(H)* A105(H)G ... PR-2-01.230512.P15.A04.H.R.1-67 PR-2-01.230512.P14.A04.K.R.1-364 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 3 230512P15A05HK A05 D15_M6_GC11 PR-2-01 6 11 RP GC d15 S64(H)G K84(H)Q N92(H)K A105(H)G N108(L)K T117... ... PR-2-01.230512.P15.A05.H.R.1-54 PR-2-01.230512.P14.A05.K.R.1-453 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 4 230512P15A06HK A06 D15_M6_GC11 PR-2-01 6 11 RP GC d15 T18(H)P N40(H)S T65(H)N A100(H)V T122(H)M K51(... ... PR-2-01.230512.P15.A06.H.R.1-46 PR-2-01.230512.P14.A06.K.R.1-194 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQPLSLTCSVTGDSITSGYWSWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPRS... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 10424 211014P07H08HK H08 D20_M22_GC88 PR-1-03 22 88 LP GC d20 T26(H)S Y55(H)F L116(L)P ... PR-1-03.211014.P07.H08.H.R.1-72 PR-1-03.211014.P07.H08.K.R.1-22 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVSGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGTNVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10425 211014P07H09HK H09 D20_M22_GC88 PR-1-03 22 88 LP GC d20 S64(H)N A105(H)G T37(L)A Y68(L)F Q105(L)H ... PR-1-03.211014.P07.H09.H.R.1-13 PR-1-03.211014.P07.H09.K.R.1-164 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTGGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10426 211014P07H10HK H10 D20_M22_GC88 PR-1-03 22 88 LP GC d20 S64(H)G T79(H)A N92(H)I A105(H)G T37(L)A N108(... ... PR-1-03.211014.P07.H10.H.R.1-11 PR-1-03.211014.P07.H10.K.R.1-175 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... 10427 211014P07H11HK H11 D20_M22_GC88 PR-1-03 22 88 LP GC d20 D28(H)A S57(H)N N92(H)I A105(H)G T37(L)A A57(L... ... PR-1-03.211014.P07.H11.H.R.1-14 PR-1-03.211014.P07.H11.K.R.1-188 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTTG... EVQLQESGPSLVKPSQTLSLTCSVTGASITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagttg... 10428 211014P07H12HK H12 D20_M22_GC88 PR-1-03 22 88 LP GC d20 D81(H)H N92(H)I A105(H)G T37(L)A S92(L)N Q105(L)H ... PR-1-03.211014.P07.H12.H.R.1-9 PR-1-03.211014.P07.H12.K.R.1-235 GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GTGTTGATGGAGACATTGTGATGACTCAGTCTCAAAAATTCATGTC... GAGGTGCAGCTTCAGGAGTCAGGACCTAGCCTCGTGAAACCTTCTC... GACATTGTGATGACTCAGTCTCAAAAATTCATGTCCACATCAGTAG... EVQLQESGPSLVKPSQTLSLTCSVTGDSITSGYWNWIRKFPGNKLE... DIVMTQSQKFMSTSVGDRVSVTCKASQNVGANVAWYQQKPGQSPKA... gaggtgcagcttcaggagtcaggacctagcctcgtgaaaccttctc... gacattgtgatgactcagtctcaaaaattcatgtccacatcagtag... <p>8744 rows \u00d7 64 columns</p> In\u00a0[7]: Copied! <pre>plt.figure(figsize=(13, 5))\nsns.pointplot(\n    data=cell_table,\n    hue=\"imm_duration\",\n    x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_bind=\"median\")).sort_values([\"imm_duration\", \"delta_bind\"]).index,\n    y=\"delta_bind\",\n    estimator=\"median\",\n    errorbar=(\"pi\", 50),\n    )\nplt.axhline(0, color=\"black\", linestyle=\"--\")\nplt.xticks(rotation=90)\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/delta_bind.pdf\")\nplt.show()\n</pre> plt.figure(figsize=(13, 5)) sns.pointplot(     data=cell_table,     hue=\"imm_duration\",     x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_bind=\"median\")).sort_values([\"imm_duration\", \"delta_bind\"]).index,     y=\"delta_bind\",     estimator=\"median\",     errorbar=(\"pi\", 50),     ) plt.axhline(0, color=\"black\", linestyle=\"--\") plt.xticks(rotation=90) plt.tight_layout() plt.savefig(f\"{output_dir}/delta_bind.pdf\") plt.show() In\u00a0[8]: Copied! <pre>plt.figure(figsize=(13, 5))\nsns.pointplot(\n    data=cell_table,\n    hue=\"imm_duration\",\n    x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_expr=\"median\")).sort_values([\"imm_duration\", \"delta_expr\"]).index,\n    y=\"delta_expr\",\n    estimator=\"median\",\n    errorbar=(\"pi\", 50),\n    )\nplt.axhline(0, color=\"black\", linestyle=\"--\")\nplt.xticks(rotation=90)\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/delta_expr.pdf\")\nplt.show()\n</pre> plt.figure(figsize=(13, 5)) sns.pointplot(     data=cell_table,     hue=\"imm_duration\",     x=\"gc\", order=cell_table.groupby(\"gc\").agg(dict(imm_duration=\"first\", delta_expr=\"median\")).sort_values([\"imm_duration\", \"delta_expr\"]).index,     y=\"delta_expr\",     estimator=\"median\",     errorbar=(\"pi\", 50),     ) plt.axhline(0, color=\"black\", linestyle=\"--\") plt.xticks(rotation=90) plt.tight_layout() plt.savefig(f\"{output_dir}/delta_expr.pdf\") plt.show() In\u00a0[9]: Copied! <pre>g = sns.JointGrid(data=cell_table, x=\"delta_bind\", y=\"delta_expr\", hue=\"imm_duration\")\ng.plot_joint(sns.scatterplot)\ng.plot_marginals(sns.kdeplot, common_norm=False, fill=True, alpha=0.1)\ng.ax_joint.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_joint.axhline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\")\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/joint_cells.pdf\")\nplt.show()\n</pre>  g = sns.JointGrid(data=cell_table, x=\"delta_bind\", y=\"delta_expr\", hue=\"imm_duration\") g.plot_joint(sns.scatterplot) g.plot_marginals(sns.kdeplot, common_norm=False, fill=True, alpha=0.1) g.ax_joint.axvline(0, color=\"black\", linestyle=\"--\") g.ax_joint.axhline(0, color=\"black\", linestyle=\"--\") g.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\") g.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\") plt.tight_layout() plt.savefig(f\"{output_dir}/joint_cells.pdf\") plt.show() In\u00a0[10]: Copied! <pre>gc_summary = (\n    (\n        cell_table.groupby(\"gc\").agg(\n            uid = pd.NamedAgg(column=\"uid\", aggfunc=\"first\"),\n            mouse = pd.NamedAgg(column=\"mouse\", aggfunc=\"first\"),\n            ngs_id = pd.NamedAgg(column=\"ngs_id\", aggfunc=\"first\"),\n            sampling_time=pd.NamedAgg(column=\"imm_duration\", aggfunc=\"first\"),\n            cells_sampled=pd.NamedAgg(column=\"uid\", aggfunc=\"count\"),\n            median_delta_bind=pd.NamedAgg(column=\"delta_bind\", aggfunc=\"median\"),\n            median_delta_expr=pd.NamedAgg(column=\"delta_expr\", aggfunc=\"median\")\n        )\n    )\n    .reset_index()\n    .set_index(\"uid\")\n    .rename(\n        columns={\n            'median_delta_bind': 'median \u0394affinity',\n            'median_delta_expr': 'median \u0394expression'\n        }\n    )\n)\n\ngc_summary\n</pre> gc_summary = (     (         cell_table.groupby(\"gc\").agg(             uid = pd.NamedAgg(column=\"uid\", aggfunc=\"first\"),             mouse = pd.NamedAgg(column=\"mouse\", aggfunc=\"first\"),             ngs_id = pd.NamedAgg(column=\"ngs_id\", aggfunc=\"first\"),             sampling_time=pd.NamedAgg(column=\"imm_duration\", aggfunc=\"first\"),             cells_sampled=pd.NamedAgg(column=\"uid\", aggfunc=\"count\"),             median_delta_bind=pd.NamedAgg(column=\"delta_bind\", aggfunc=\"median\"),             median_delta_expr=pd.NamedAgg(column=\"delta_expr\", aggfunc=\"median\")         )     )     .reset_index()     .set_index(\"uid\")     .rename(         columns={             'median_delta_bind': 'median \u0394affinity',             'median_delta_expr': 'median \u0394expression'         }     ) )  gc_summary Out[10]: gc mouse ngs_id sampling_time cells_sampled median \u0394affinity median \u0394expression uid D15_M1_GC1 1 1 PR-2-01 d15 67 0.773400 -0.05788 D15_M1_GC2 2 1 PR-2-01 d15 79 0.397360 -0.03688 D15_M1_GC3 3 1 PR-2-01 d15 73 0.535100 -0.06153 D15_M2_GC4 4 2 PR-2-01 d15 44 0.287630 -0.08646 D15_M3_GC5 5 3 PR-2-01 d15 78 0.000000 -0.08452 ... ... ... ... ... ... ... ... D20_M24_GC115 115 24 PR-1-04 d20 85 1.046480 -0.17240 D20_M25_GC116 116 25 PR-1-02 d20 78 1.105020 -0.03121 D20_M25_GC117 117 25 PR-1-03 d20 76 0.608315 -0.51338 D20_M25_GC118 118 25 PR-1-08 d20 70 0.491020 -0.02191 D20_M25_GC119 119 25 PR-1-08 d20 81 0.698655 -0.26017 <p>119 rows \u00d7 7 columns</p> In\u00a0[11]: Copied! <pre>cols_to_keep = [\n    # 'cells sampled',\n    'normalized dominance score',\n    'maximum REI',\n    'max \u0394affinity',\n    '95th percentile \u0394affinity',\n    # 'mean \u0394affinity',\n    # 'median \u0394affinity', \n    'id of max REI node', \n    'mutations in max REI node', \n    '\u0394affinity of max REI node',\n    '\u0394\u0394affinity of max REI node',\n    'max REI node is root'\n]\nnds_lb = pd.read_csv(nds_lb_summary_csv, index_col=\"uid\")[cols_to_keep]\nnds_lb.info()\n</pre> cols_to_keep = [     # 'cells sampled',     'normalized dominance score',     'maximum REI',     'max \u0394affinity',     '95th percentile \u0394affinity',     # 'mean \u0394affinity',     # 'median \u0394affinity',      'id of max REI node',      'mutations in max REI node',      '\u0394affinity of max REI node',     '\u0394\u0394affinity of max REI node',     'max REI node is root' ] nds_lb = pd.read_csv(nds_lb_summary_csv, index_col=\"uid\")[cols_to_keep] nds_lb.info() <pre>&lt;class 'pandas.core.frame.DataFrame'&gt;\nIndex: 119 entries, D20_M22_GC96 to D15_M13_GC31\nData columns (total 9 columns):\n #   Column                      Non-Null Count  Dtype  \n---  ------                      --------------  -----  \n 0   normalized dominance score  119 non-null    float64\n 1   maximum REI                 119 non-null    float64\n 2   max \u0394affinity               119 non-null    float64\n 3   95th percentile \u0394affinity   119 non-null    float64\n 4   id of max REI node          119 non-null    object \n 5   mutations in max REI node   113 non-null    object \n 6   \u0394affinity of max REI node   119 non-null    float64\n 7   \u0394\u0394affinity of max REI node  119 non-null    float64\n 8   max REI node is root        119 non-null    bool   \ndtypes: bool(1), float64(6), object(2)\nmemory usage: 8.5+ KB\n</pre> In\u00a0[12]: Copied! <pre>gc_summary = gc_summary.join(nds_lb)\ngc_summary.to_csv(f\"{output_dir}/gc_summary.csv\")\n</pre> gc_summary = gc_summary.join(nds_lb) gc_summary.to_csv(f\"{output_dir}/gc_summary.csv\") In\u00a0[13]: Copied! <pre>gc_summary.info()\n</pre> gc_summary.info() <pre>&lt;class 'pandas.core.frame.DataFrame'&gt;\nIndex: 119 entries, D15_M1_GC1 to D20_M25_GC119\nData columns (total 16 columns):\n #   Column                      Non-Null Count  Dtype  \n---  ------                      --------------  -----  \n 0   gc                          119 non-null    int64  \n 1   mouse                       119 non-null    int64  \n 2   ngs_id                      119 non-null    object \n 3   sampling_time               119 non-null    object \n 4   cells_sampled               119 non-null    int64  \n 5   median \u0394affinity            119 non-null    float64\n 6   median \u0394expression          119 non-null    float64\n 7   normalized dominance score  119 non-null    float64\n 8   maximum REI                 119 non-null    float64\n 9   max \u0394affinity               119 non-null    float64\n 10  95th percentile \u0394affinity   119 non-null    float64\n 11  id of max REI node          119 non-null    object \n 12  mutations in max REI node   113 non-null    object \n 13  \u0394affinity of max REI node   119 non-null    float64\n 14  \u0394\u0394affinity of max REI node  119 non-null    float64\n 15  max REI node is root        119 non-null    bool   \ndtypes: bool(1), float64(8), int64(3), object(4)\nmemory usage: 19.1+ KB\n</pre> In\u00a0[14]: Copied! <pre>g = sns.JointGrid(data=gc_summary, x=\"median \u0394affinity\", y=\"median \u0394expression\", hue=\"sampling_time\")\ng.plot_joint(sns.scatterplot, size=gc_summary.cells_sampled)\ng.plot_marginals(sns.kdeplot, common_norm=False)\ng.ax_joint.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_joint.axhline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\")\ng.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\")\nplt.tight_layout()\nplt.savefig(f\"{output_dir}/joint_gc_medians.pdf\")\nplt.show()\n</pre> g = sns.JointGrid(data=gc_summary, x=\"median \u0394affinity\", y=\"median \u0394expression\", hue=\"sampling_time\") g.plot_joint(sns.scatterplot, size=gc_summary.cells_sampled) g.plot_marginals(sns.kdeplot, common_norm=False) g.ax_joint.axvline(0, color=\"black\", linestyle=\"--\") g.ax_joint.axhline(0, color=\"black\", linestyle=\"--\") g.ax_marg_x.axvline(0, color=\"black\", linestyle=\"--\") g.ax_marg_y.axhline(0, color=\"black\", linestyle=\"--\") plt.tight_layout() plt.savefig(f\"{output_dir}/joint_gc_medians.pdf\") plt.show() In\u00a0[15]: Copied! <pre>sns.boxenplot(data=gc_summary, y=\"median \u0394affinity\", hue=\"sampling_time\")\nplt.show()\nsns.boxenplot(data=gc_summary, y=\"median \u0394expression\", hue=\"sampling_time\")\nplt.show()\n</pre> sns.boxenplot(data=gc_summary, y=\"median \u0394affinity\", hue=\"sampling_time\") plt.show() sns.boxenplot(data=gc_summary, y=\"median \u0394expression\", hue=\"sampling_time\") plt.show()"},{"location":"analysis/cell-summaries/naive_reversions_no_bp/#summary-stats","title":"Summary stats\u00b6","text":""},{"location":"analysis/cell-summaries/naive_reversions_no_bp/#cell-wise-stats","title":"Cell-wise stats\u00b6","text":""},{"location":"analysis/cell-summaries/naive_reversions_no_bp/#gc-wise-stats","title":"GC-wise stats\u00b6","text":""}]}